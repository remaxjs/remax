<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://gw.alipayobjects.com/mdn/rms_b5fcc5/afts/img/A*1NHAQYduQiQAAAAAAAAAAABkARQnAQ"
    />
    <style>
      .markdown.markdown blockquote {
        background-color: rgba(255, 229, 100, 0.3);
        color: #454d64;
        border-left-color: #ffe564;
        border-left-width: 9px;
        border-left-style: solid;
        padding: 20px 45px 20px 26px;
        margin-bottom: 30px;
        margin-top: 20px;
        margin-left: -30px;
        margin-right: -30px;
      }

      .markdown.markdown blockquote p:first-of-type {
        font-weight: 700;
        margin-top: 0;
        margin-bottom: 0;
      }
    </style>
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.0
    </script>
    <title>2.0 迁移指南</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/guide/v2-migration" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;https://gw.alipayobjects.com/mdn/rms_b5fcc5/afts/img/A*1NHAQYduQiQAAAAAAAAAAABkARQnAQ&#x27;)" href="/">Remax</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/guide">文档</a></span><span><a href="/api">API</a></span><span><a href="/faq">FAQ</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/awesome-remax">awesome-remax<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/remaxjs">开发博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/remax/releases">更新日志<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://v1.remaxjs.org">v1 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/remax">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://gw.alipayobjects.com/mdn/rms_b5fcc5/afts/img/A*1NHAQYduQiQAAAAAAAAAAABkARQnAQ&#x27;)" href="/"></a><h1>Remax</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/guide">文档</a></li><li><a href="/api">API</a></li><li><a href="/faq">FAQ</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/awesome-remax">awesome-remax<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/remaxjs">开发博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/remax/releases">更新日志<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://v1.remaxjs.org">v1 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/remax">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/guide/quick-start">快速上手</a></li><li><a href="/guide/framework">框架</a><ul><li><a href="/guide/framework/app"><span>App</span></a></li><li><a href="/guide/framework/page"><span>页面</span></a></li><li><a href="/guide/framework/component"><span>组件</span></a></li><li><a href="/guide/framework/api"><span>API</span></a></li><li><a href="/guide/framework/style"><span>样式</span></a></li><li><a href="/guide/framework/event"><span>事件</span></a></li></ul></li><li><a href="/guide/config">配置</a><ul><li><a href="/guide/config/remax"><span>Remax 配置</span></a></li><li><a href="/guide/config/babel"><span>Babel 配置</span></a></li><li><a href="/guide/config/postcss"><span>PostCSS 配置</span></a></li><li><a href="/guide/config/environment-variables"><span>环境变量</span></a></li></ul></li><li><a href="/guide/basic">基础指南</a><ul><li><a href="/guide/basic/react"><span>React</span></a></li><li><a href="/guide/basic/custom-component"><span>小程序自定义组件</span></a></li><li><a href="/guide/basic/plugin"><span>小程序插件</span></a></li><li><a href="/guide/basic/public"><span>public 目录</span></a></li><li><a href="/guide/basic/devtools"><span>调试工具</span></a></li><li><a href="/guide/basic/cli"><span>CLI 命令行</span></a></li><li><a href="/guide/basic/error-handling"><span>错误处理</span></a></li></ul></li><li><a href="/guide/advanced">进阶指南</a><ul><li><a href="/guide/advanced/plugin"><span>使用插件</span></a></li><li><a href="/guide/advanced/typescript"><span>TypeScript</span></a></li><li><a href="/guide/advanced/sharing-state"><span>状态共享</span></a></li><li><a href="/guide/advanced/hybrid"><span>混合开发</span></a></li><li><a href="/guide/advanced/performance"><span>性能优化</span></a></li></ul></li><li><a href="/guide/writing-mini-plugins">小程序插件开发</a></li><li><a href="/guide/one">跨平台开发</a><ul><li><a href="/guide/one"><span>小程序应用</span></a></li><li><a href="/guide/one/web"><span>Web 应用</span></a></li></ul></li><li><a href="/guide/implementation-notes">实现原理</a></li><li><a aria-current="page" class="active" href="/guide/v2-migration">2.0 迁移指南</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="升级依赖" data-depth="2"><a href="/guide/v2-migration#升级依赖"><span>升级依赖</span></a></li><li title="alipay -&gt; ali" data-depth="2"><a href="/guide/v2-migration#alipay---ali"><span>alipay -&gt; ali</span></a></li><li title="remax.config.js" data-depth="2"><a href="/guide/v2-migration#remaxconfigjs"><span>remax.config.js</span></a></li><li title="用 configWebpack 代替 rollupOptions" data-depth="3"><a href="/guide/v2-migration#用-configwebpack-代替-rollupoptions"><span>用 configWebpack 代替 rollupOptions</span></a></li><li title="废弃 alias 配置" data-depth="3"><a href="/guide/v2-migration#废弃-alias-配置"><span>废弃 alias 配置</span></a></li><li title="废弃 postcss 配置" data-depth="3"><a href="/guide/v2-migration#废弃-postcss-配置"><span>废弃 postcss 配置</span></a></li><li title="废弃 cssModules 配置" data-depth="3"><a href="/guide/v2-migration#废弃-cssmodules-配置"><span>废弃 cssModules 配置</span></a></li><li title="app.js" data-depth="2"><a href="/guide/v2-migration#appjs"><span>app.js</span></a></li><li title="生命周期" data-depth="2"><a href="/guide/v2-migration#生命周期"><span>生命周期</span></a></li><li title="样式" data-depth="2"><a href="/guide/v2-migration#样式"><span>样式</span></a></li><li title="通过插件支持 CSS 预处理器" data-depth="3"><a href="/guide/v2-migration#通过插件支持-css-预处理器"><span>通过插件支持 CSS 预处理器</span></a></li><li title="CSS 中的图片" data-depth="3"><a href="/guide/v2-migration#css-中的图片"><span>CSS 中的图片</span></a></li><li title="tabBar 中配置的本地图片" data-depth="3"><a href="/guide/v2-migration#tabbar-中配置的本地图片"><span>tabBar 中配置的本地图片</span></a></li><li title="Remax" data-depth="2"><a href="/guide/v2-migration#remax"><span>Remax</span></a></li><li title="useNativeEffect" data-depth="3"><a href="/guide/v2-migration#usenativeeffect"><span>useNativeEffect</span></a></li><li title="Remax One" data-depth="2"><a href="/guide/v2-migration#remax-one"><span>Remax One</span></a></li><li title="Event" data-depth="3"><a href="/guide/v2-migration#event"><span>Event</span></a></li><li title="Input 和 Textarea 组件" data-depth="3"><a href="/guide/v2-migration#input-和-textarea-组件"><span>Input 和 Textarea 组件</span></a></li><li title="Image 组件" data-depth="3"><a href="/guide/v2-migration#image-组件"><span>Image 组件</span></a></li><li title="使用原生插件" data-depth="2"><a href="/guide/v2-migration#使用原生插件"><span>使用原生插件</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><p>如果你有 1.0 的 Remax 项目需要升级，请按照这篇文档的指引进行。</p><h2 id="升级依赖"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#升级依赖"><span class="icon,icon-link"></span></a>升级依赖</h2><p>Remax 2.0 只需要你安装一个依赖 <code>remax</code>。</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">{</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged">  ...,</span></div><div class="token-line"><span class="token unchanged">  &quot;dependencies&quot;: {</span></div><div class="token-line"><span class="token unchanged"></span><span class="token deleted-sign deleted">-    &quot;remax&quot;: &quot;^1.0.0&quot;,</span></div><div class="token-line"><span class="token deleted-sign deleted">-    &quot;remax-cli&quot;: &quot;^1.0.0&quot;,</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+    &quot;remax&quot;: &quot;^2.0.0&quot;,</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token unchanged">  }</span></div><div class="token-line"><span class="token unchanged"></span><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="alipay---ali"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#alipay---ali"><span class="icon,icon-link"></span></a>alipay -&gt; ali</h2><p>2.0 将 <code>alipay</code> 重名为 <code>ali</code>，表示支持所有阿里小程序。</p><p>因此原本和 <code>alipay</code> 相关的内容都需要改成 <code>ali</code></p><p>package.json 中 build target 从 <code>alipay</code> 改成 <code>ali</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">&quot;scripts&quot;: {</span></div><div class="token-line"><span class="token plain"></span><span class="token deleted-sign deleted">-  &quot;dev“: &quot;remax build -t alipay -w&quot;,</span></div><div class="token-line"><span class="token deleted-sign deleted">-  &quot;build“: &quot;cross-env NODE_ENV=production remax build -t alipay&quot;,</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  &quot;dev“: &quot;remax build -t ali -w&quot;,</span></div><div class="token-line"><span class="token inserted-sign inserted">+  &quot;build“: &quot;cross-env NODE_ENV=production remax build -t ali&quot;,</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>remax/alipay</code> -&gt; <code>remax/ali</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import {</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged">  View, naviageTo</span></div><div class="token-line"><span class="token unchanged"></span><span class="token deleted-sign deleted">- } from &#x27;remax/alipay&#x27;</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ } from &#x27;remax/ali&#x27;</span></div><div class="token-line"><span class="token inserted-sign inserted"></span></div></pre></div><p>App 和页面配置 <code>alipay</code> 平台变成 <code>ali</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-sign deleted">- exports.alipay = {</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ exports.ali = {</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token unchanged">  defaultTitle: &#x27;&#x27;,</span></div><div class="token-line"><span class="token unchanged">  ...</span></div><div class="token-line"><span class="token unchanged"></span><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>文件同构后缀名 <code>alipay.js</code> 变成 <code>ali.js</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-sign deleted">- index.alipay.js</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ index.ali.js</span></div><div class="token-line"><span class="token inserted-sign inserted"></span></div></pre></div><p><code>remax/one</code> 组件的平台前缀 <code>alipay-</code> 变成 <code>ali-</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-arrow deleted">&lt;View</span></div><div class="token-line"><span class="token deleted-arrow deleted"></span><span class="token deleted-sign deleted">-  alipay-onFirstAppear={() =&gt; {}}</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  ali-onFirstAppear={() =&gt; {}}</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token inserted-arrow inserted">&gt;</span></div><div class="token-line"><span class="token inserted-arrow inserted"></span></div></pre></div><h2 id="remaxconfigjs"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#remaxconfigjs"><span class="icon,icon-link"></span></a>remax.config.js</h2><p><a href="/guide/config">详细配置文档</a></p><h3 id="用-configwebpack-代替-rollupoptions"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#用-configwebpack-代替-rollupoptions"><span class="icon,icon-link"></span></a>用 <code>configWebpack</code> 代替 <code>rollupOptions</code></h3><p>2.0 将构建工具从 <code>Rollup</code> 切换到 <code>Webpack</code>，因此废弃 <code>rollupOptions</code>，通过 <code>configWebpack</code> 可以修改 webpack 配置。<code>configWebpack</code> 方法将传入一个 <a target="_blank" rel="noopener noreferrer" href="https://github.com/neutrinojs/webpack-chain">webpack-chain<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的 <code>Config</code> 对象。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// remax.config.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">configWebpack</span><span class="token punctuation">(</span><span class="token parameter punctuation">{</span><span class="token parameter"> config </span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// config 是 webpack-chain 的 Config 对象</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    config</span><span class="token punctuation">.</span><span class="token property-access">plugins</span><span class="token punctuation">.</span><span class="token method function property-access">delete</span><span class="token punctuation">(</span><span class="token string">&#x27;webpackbar&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// 删除 webpackbar 插件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="废弃-alias-配置"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#废弃-alias-配置"><span class="icon,icon-link"></span></a>废弃 <code>alias</code> 配置</h3><p>通过 <code>configWebpack</code> 修改 <code>webpack alias</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// remax.config.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">configWebpack</span><span class="token punctuation">(</span><span class="token parameter punctuation">{</span><span class="token parameter"> config </span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    config</span><span class="token punctuation">.</span><span class="token property-access">resolve</span><span class="token punctuation">.</span><span class="token property-access">alias</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">.</span><span class="token method function property-access">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;@components&#x27;</span><span class="token punctuation">:</span><span class="token plain"> path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">cwd</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;src/components&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">.</span><span class="token method function property-access">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="废弃-postcss-配置"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#废弃-postcss-配置"><span class="icon,icon-link"></span></a>废弃 <code>postcss</code> 配置</h3><p>通过 <code>postcss.config.js</code> 来修改 <code>postcss</code> 配置</p><p>以添加 <code>postcss-url</code> 插件为例:</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 在项目根目录下新建 postcss.config.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter punctuation">{</span><span class="token parameter"> options </span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  plugins</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 应用 remax 默认的插件配置</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token spread operator">...</span><span class="token plain">options</span><span class="token punctuation">.</span><span class="token property-access">plugins</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;postcss-url&#x27;</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> url</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;inline&#x27;</span><span class="token punctuation">,</span><span class="token plain"> maxSize</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">15</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="废弃-cssmodules-配置"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#废弃-cssmodules-配置"><span class="icon,icon-link"></span></a>废弃 <code>cssModules</code> 配置</h3><p>2.0 将会自动识别 CSS Modules</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 识别成 css modules</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> styles </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;./index.css&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 不启用 css modules</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token string">&#x27;./index.css&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="appjs"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#appjs"><span class="icon,icon-link"></span></a>app.js</h2><p>2.0 废弃了非 React 组件定义 App 的方式。如果你是用 React 组件定义 App，则无需改动。</p><p>详情请查看 <a href="/guide/framework#%E5%BA%94%E7%94%A8">框架 - 应用</a></p><h2 id="生命周期"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#生命周期"><span class="icon,icon-link"></span></a>生命周期</h2><p>2.0 废弃了所有特有的生命周期 hook，例如: <code>onShow</code>， <code>onHide</code>， <code>onShareAppMessage</code> 等等。</p><p>1.0 提供的生命周期通用 hook <code>usePageEvent</code>， <code>useAppEvent</code> 改为从 <code>remax/macro</code> 导出。</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-sign deleted">- import { useShow, useHide, usePageEvent, useAppEvent ... } from &#x27;remax&#x27;;</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ import { usePageEvent, useAppEvent } from &#x27;remax/macro&#x27;;</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token plain"></span></div><div class="token-line"><span class="token plain">...</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token deleted-sign deleted">- useShow(() =&gt; { console.log(&#x27;onShow&#x27;); });</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ usePageEvent(&#x27;onShow&#x27;, () =&gt; { console.log(&#x27;onShow&#x27;); })</span></div><div class="token-line"><span class="token inserted-sign inserted"></span></div></pre></div><h2 id="样式"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#样式"><span class="icon,icon-link"></span></a>样式</h2><h3 id="通过插件支持-css-预处理器"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#通过插件支持-css-预处理器"><span class="icon,icon-link"></span></a>通过插件支持 CSS 预处理器</h3><p>2.0 不再默认支持 Less、Sass 和 Stylus，需要通过对应的插件来支持。</p><p><a target="_blank" rel="noopener noreferrer" href="https://remaxjs.org/guide/advanced/plugin">使用插件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a target="_blank" rel="noopener noreferrer" href="https://github.com/remaxjs/plugins#%E6%8F%92%E4%BB%B6%E5%88%97%E8%A1%A8">插件列表<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="css-中的图片"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#css-中的图片"><span class="icon,icon-link"></span></a>CSS 中的图片</h3><p>1.0 中，CSS 不支持相对路径引入图片，绝对路径 remax 则会自动复制图片到输出目录的对应位置。</p><p>与 1.0 不同，2.0 中我们将遵循 <a target="_blank" rel="noopener noreferrer" href="https://github.com/webpack-contrib/css-loader#url">css-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的规则：</p><ol><li><p><code>/path/to/image.png</code>， 绝对路径表示对应输出目录中的 <code>/path/to</code> 路径位置，归类为 global assets，可以放置在 public 目录下。</p></li><li><p><code>~@/assets/image.png</code>， <code>~</code> 开头表示引入的是 module，可以是 src 下的图片， webpack 可以 resolve。</p></li><li><p><code>../../assets/image.png</code>， 相对路径也会被识别为 module，webpack 会处理。</p></li></ol><p>对于情况 1， 中的图片，可以放在项目根目录中的 public 目录中。public 目录中的文件会被复制到 dist 目录中。</p><p>例如：<code>public/path/to/image.png</code> 会被复制到 <code>dist/path/to/image.png</code></p><h3 id="tabbar-中配置的本地图片"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#tabbar-中配置的本地图片"><span class="icon,icon-link"></span></a>tabBar 中配置的本地图片</h3><p>tabBar 中配置的本地图片都是以绝对路径开头，因此代表的也是 global assets，需要你自行配置 copy 行为，与上述一致。</p><h2 id="remax"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#remax"><span class="icon,icon-link"></span></a>Remax</h2><h3 id="usenativeeffect"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#usenativeeffect"><span class="icon,icon-link"></span></a>useNativeEffect</h3><p>useNativeEffect hook 去除 <code>unstable</code> 前缀</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import {</span></div><div class="token-line"><span class="token plain"></span><span class="token deleted-sign deleted">-  unstable_useNativeEffect,</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  useNativeEffect,</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token plain">} from &#x27;remax&#x27;</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>废弃 Platform</p><p>出于对代码 uglify 的考虑，2.0 去除了 <code>Platform</code> 模块。如果你需要判断平台，请使用 <code>process.env.REMAX_PLATFORM</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-sign deleted">- import { Platform } from &#x27;remax&#x27;;</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token deleted-sign deleted">- if (Platform.isWechat ) {</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ if (process.env.REMAX_PLATFORM === &#x27;wechat&#x27;) {</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token unchanged">  ...</span></div><div class="token-line"><span class="token unchanged"></span><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><blockquote><p>如果需要做到代码 uglify，就必须直接写明 <code>process.env.REMAX_PLATFORM</code>，不可以封装一个方法去调用</p></blockquote><h2 id="remax-one"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#remax-one"><span class="icon,icon-link"></span></a>Remax One</h2><h3 id="event"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#event"><span class="icon,icon-link"></span></a>Event</h3><p>为了与 React DOM 对齐，2.0 中 <code>remax/one</code> 事件的 <code>originalEvent</code> 改为 <code>nativeEvent</code></p><p>详情参考：<a href="/api/remax-one/event">API - remax/one</a></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">function handleTap(event) {</span></div><div class="token-line"><span class="token plain"></span><span class="token deleted-sign deleted">-  console.log(event.originalEvent);</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  console.log(event.nativeEvent);</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="input-和-textarea-组件"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#input-和-textarea-组件"><span class="icon,icon-link"></span></a>Input 和 Textarea 组件</h3><p><code>remax/one</code> 中的 <code>Input</code> 和 <code>Textarea</code> 组件的 <code>maxlength</code> 属性和 React 对齐，改为 <code>maxLength</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-arrow deleted">&lt;Input</span></div><div class="token-line"><span class="token deleted-arrow deleted"></span><span class="token deleted-sign deleted">-  maxlength={140}</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  maxLength={140}</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token inserted-arrow inserted">&gt;</span></div><div class="token-line"><span class="token inserted-arrow inserted"></span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token deleted-arrow deleted">&lt;Textarea</span></div><div class="token-line"><span class="token deleted-arrow deleted"></span><span class="token deleted-sign deleted">-  maxlength={140}</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  maxLength={140}</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token inserted-arrow inserted">&gt;</span></div><div class="token-line"><span class="token inserted-arrow inserted"></span></div></pre></div><h3 id="image-组件"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#image-组件"><span class="icon,icon-link"></span></a>Image 组件</h3><p>2.0 中 Image 组件的 <code>lazyLoad</code> 属性不再是平台通用属性</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-arrow deleted">&lt;Image</span></div><div class="token-line"><span class="token deleted-arrow deleted"></span><span class="token deleted-sign deleted">-  lazyLoad={true}</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+  wechat-lazy-load={true}</span></div><div class="token-line"><span class="token inserted-sign inserted">+  ali-lazy-load={true}</span></div><div class="token-line"><span class="token inserted-sign inserted">+  toutiao-lazy-load={true}</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token inserted-arrow inserted">&gt;</span></div><div class="token-line"><span class="token inserted-arrow inserted"></span></div></pre></div><h2 id="使用原生插件"><a aria-hidden="true" tabindex="-1" href="/guide/v2-migration#使用原生插件"><span class="icon,icon-link"></span></a>使用原生插件</h2><p>原本直接引入插件的用法废弃，改为使用 <code>remax/macro</code> 提供的 <code>requirePlugin</code> 和 <code>requirePluginComponent</code> 方法使用</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-sign deleted">- import PluginComponent from &#x27;plugin://xxx&#x27;;</span></div><div class="token-line"><span class="token deleted-sign deleted"></span><span class="token inserted-sign inserted">+ import { requirePlugin, requirePluginComponent } from &#x27;remax/macro&#x27;;</span></div><div class="token-line"><span class="token inserted-sign inserted"></span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token inserted-sign inserted">+ const PluginComponent = requirePluginComponent(&#x27;plugin://xxx&#x27;);</span></div><div class="token-line"><span class="token inserted-sign inserted">+ const PluginMethod = requirePlugin(&#x27;plugin://xxx&#x27;);</span></div><div class="token-line"><span class="token inserted-sign inserted"></span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="最后更新时间：">8/16/2021, 12:43:56</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="https://www.googletagmanager.com/gtag/js?id=UA-145491804-1"></script>
    <script>
      window.GATSBY_GTAG_PLUGIN_GA_TRACKING_ID = "UA-145491804-1";
      window.GATSBY_GTAG_PLUGIN_ANONYMIZE = false;

      var options = {
        send_page_view: false,
      };
      if (false) {
        options.anonymize_ip = true;
      }

      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      window.gtag = gtag;
      gtag("js", new Date());
      gtag("config", "UA-145491804-1", options);
    </script>
    <script src="/umi.js"></script>
  </body>
</html>
